apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: {{ .Release.Name }}-ingress
  namespace: {{ .Release.namespace }}
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
  # {{if eq .Values.tls true}}
  #    cert-manager.io/cluster-issuer: letsencrypt-prod
  # {{end}}

spec:
  ingressClassName: nginx
  defaultBackend:
    service:
      name: error
      port:
        name: svc-port
# {{if eq .Values.tls true}}
#   tls:
#   - hosts: 
#     - host1.domain.ext
#     - host2.domain.ext
#     secretName: {{ .Release.Name }}-tls
# {{end}}
  rules:
  - host: 
    http:
      paths:
        - path: /{{ .Release.Name }}
          pathType: Prefix
          backend:
            service:
              name: {{ .Release.Name }}-service
              port:
                number: 80 